<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:dt="uuid:C2F41010-65B3-11d1-A29F-00AA00C14882"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<link rel=File-List href="paper2.files/filelist.xml">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
b\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>页标题</title>
<style>
<!--
 /* 字体定义 */
@font-face
	{font-family:"Times New Roman";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
 /* 样式定义 */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:left;
	font-family:"Times New Roman";
	font-size:12.0pt;
	color:black;}
h1
	{margin-left:18.0pt;
	margin-right:0pt;
	text-indent:-18.0pt;
	margin-top:12.0pt;
	margin-bottom:6.0pt;
	text-align:center;
	font-family:"Times New Roman";
	font-size:11.0pt;
	color:black;
	font-weight:bold;
	text-transform:uppercase;}
h2
	{margin-left:18.0pt;
	margin-right:0pt;
	text-indent:-18.0pt;
	margin-top:0pt;
	margin-bottom:6.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;
	font-weight:bold;}
p.SPIEreferences, li.SPIEreferences, div.SPIEreferences
	{mso-style-name:SPIEreferences;
	margin-right:0pt;
	text-indent:0pt;
	margin-top:24.0pt;
	margin-bottom:12.0pt;
	text-align:center;
	font-family:"Times New Roman";
	font-size:11.0pt;
	color:black;
	font-weight:bold;
	text-transform:uppercase;}
p.SPIEbodytext, li.SPIEbodytext, div.SPIEbodytext
	{mso-style-name:"SPIE body text";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:6.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:left;
	font-family:Times;
	font-size:12.0pt;
	color:black;}
p.SPIEabstractbodytext, li.SPIEabstractbodytext, div.SPIEabstractbodytext
	{mso-style-name:"SPIE abstract body text";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:6.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
p.SPIEfigureright, li.SPIEfigureright, div.SPIEfigureright
	{mso-style-name:"SPIE figure right";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:6.0pt;
	margin-bottom:6.0pt;
	text-align:right;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
p.BodyofPaper, li.BodyofPaper, div.BodyofPaper
	{mso-style-name:"*Body of Paper*";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
p.StyleSPIEfigurecaption, li.StyleSPIEfigurecaption, div.StyleSPIEfigurecaption
	{mso-style-name:"Style SPIE figure caption";
	margin-left:36.0pt;
	margin-right:18.0pt;
	text-indent:-18.0pt;
	margin-top:0pt;
	margin-bottom:6.0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:9.0pt;
	color:black;}
p.SPIEfigurecaption, li.SPIEfigurecaption, div.SPIEfigurecaption
	{mso-style-name:"SPIE figure caption";
	margin-left:36.0pt;
	margin-right:18.0pt;
	text-indent:-18.0pt;
	margin-top:0pt;
	margin-bottom:6.0pt;
	text-align:left;
	font-family:"Times New Roman";
	font-size:9.0pt;
	color:black;}
p.SPIEpapertitle, li.SPIEpapertitle, div.SPIEpapertitle
	{mso-style-name:"SPIE paper title";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:center;
	font-family:"Times New Roman";
	font-size:16.0pt;
	color:black;
	font-weight:bold;}
p.SPIEfigure, li.SPIEfigure, div.SPIEfigure
	{mso-style-name:"SPIE figure";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:6.0pt;
	margin-bottom:6.0pt;
	text-align:center;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
p.SPIEabstracttitle, li.SPIEabstracttitle, div.SPIEabstracttitle
	{mso-style-name:"SPIE abstract title";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:24.0pt;
	margin-bottom:12.0pt;
	text-align:center;
	font-family:"Times New Roman";
	font-size:11.0pt;
	color:black;
	font-weight:bold;
	text-transform:uppercase;}
p.SPIEAuthorsAffils, li.SPIEAuthorsAffils, div.SPIEAuthorsAffils
	{mso-style-name:"SPIE Authors-Affils";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:center;
	font-family:"Times New Roman";
	font-size:12.0pt;
	color:black;}
p.SPIEheader, li.SPIEheader, div.SPIEheader
	{mso-style-name:"SPIE header";
	margin-left:18.0pt;
	margin-right:18.0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:left;
	font-family:"Times New Roman";
	font-size:9.0pt;
	color:black;}
p.SPIEreferencelisting, li.SPIEreferencelisting, div.SPIEreferencelisting
	{mso-style-name:"SPIE reference listing";
	margin-right:0pt;
	text-indent:0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
p.Keywords, li.Keywords, div.Keywords
	{mso-style-name:*Keywords*;
	margin-left:18.0pt;
	margin-right:0pt;
	text-indent:-18.0pt;
	margin-top:0pt;
	margin-bottom:0pt;
	text-align:justify;
	text-justify:inter-ideograph;
	font-family:"Times New Roman";
	font-size:10.0pt;
	color:black;}
ol
	{margin-top:0in;
	margin-bottom:0in;
	margin-left:-2197in;}
ul
	{margin-top:0in;
	margin-bottom:0in;
	margin-left:-2197in;}
@page
	{size:8.-2019in 11.2232in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="3187" fill="f" fillcolor="white [7]"
  strokecolor="black [0]">
  <v:fill color="white [7]" color2="white [7]" on="f"/>
  <v:stroke color="black [0]" color2="white [7]">
   <o:left v:ext="view" color="black [0]" color2="white [7]"/>
   <o:top v:ext="view" color="black [0]" color2="white [7]"/>
   <o:right v:ext="view" color="black [0]" color2="white [7]"/>
   <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
   <o:column v:ext="view" color="black [0]" color2="white [7]"/>
  </v:stroke>
  <v:shadow color="#ccc [4]"/>
  <v:textbox inset="2.88pt,2.88pt,2.88pt,2.88pt"/>
  <o:colormenu v:ext="edit" fillcolor="blue [1]" strokecolor="black [0]"
   shadowcolor="#ccc [4]"/>
 </o:shapedefaults><o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body style='margin:0'>

<div style='position:absolute;width:7.-71in;height:64.0485in'>

<!--[if gte vml 1]><v:shapetype id="_x0000_t202" coordsize="21600,21600" o:spt="202"
 path="m,l,21600r21600,l21600,xe">
 <v:stroke joinstyle="miter"/>
 <v:path gradientshapeok="t" o:connecttype="rect"/>
</v:shapetype><v:shape id="_x0000_s1026" type="#_x0000_t202" style='position:absolute;
 left:70.86pt;top:49.26pt;width:428.27pt;height:21.6pt;z-index:-21;
 mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
 mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt' filled="f"
 fillcolor="white [7]" stroked="f" strokecolor="black [0]" o:cliptowrap="t">
 <v:fill color2="white [7]"/>
 <v:stroke color2="white [7]">
  <o:left v:ext="view" color="black [0]" color2="white [7]"/>
  <o:top v:ext="view" color="black [0]" color2="white [7]"/>
  <o:right v:ext="view" color="black [0]" color2="white [7]"/>
  <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
  <o:column v:ext="view" color="black [0]" color2="white [7]"/>
 </v:stroke>
 <v:shadow color="#ccc [4]"/>
 <v:path insetpenok="f"/>
 <v:textbox style='mso-column-margin:2mm' inset="2.88pt,2.88pt,2.88pt,2.88pt"/>
</v:shape><![endif]--><![if !vml]><span style='position:absolute;z-index:-21;
left:142px;top:99px;width:857px;height:44px'>

<table cellpadding=0 cellspacing=0>
 <tr>
  <td width=857 height=44 style='vertical-align:top'><![endif]>
  <div v:shape="_x0000_s1026" style='padding:2.88pt 2.88pt 2.88pt 2.88pt'
  class=shape>
  <p class=MsoHeader><span lang=en-US style='font-family:Times;language:en-US'>&nbsp;</span></p>
  <p class=MsoHeader><span lang=en-US style='font-family:Times;language:en-US'>&nbsp;</span></p>
  <p class=SPIEheader><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=MsoHeader><span lang=en-US style='font-family:Times;language:en-US'>&nbsp;</span></p>
  <p class=MsoHeader style='text-align:justify;text-justify:inter-ideograph;
  text-align:justify;text-justify:inter-ideograph'><span lang=zh-CN
  style='font-size:10.5pt;font-family:宋体;color:black;language:zh-CN'>&nbsp;</span></p>
  <p class=MsoNormal><span lang=zh-CN style='font-family:宋体;language:zh-CN'>&nbsp;</span></p>
  </div>
  <![if !vml]></td>
 </tr>
</table>

</span><![endif]>
<!--[if gte vml 1]><v:shape id="_x0000_s1025" type="#_x0000_t202" style='position:absolute;
 left:54pt;top:66pt;width:459.3pt;height:4612.01pt;z-index:1;
 mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
 mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt' filled="f"
 fillcolor="white [7]" stroked="f" strokecolor="black [0]" o:cliptowrap="t">
 <v:fill color2="white [7]"/>
 <v:stroke color2="white [7]">
  <o:left v:ext="view" color="black [0]" color2="white [7]"/>
  <o:top v:ext="view" color="black [0]" color2="white [7]"/>
  <o:right v:ext="view" color="black [0]" color2="white [7]"/>
  <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
  <o:column v:ext="view" color="black [0]" color2="white [7]"/>
 </v:stroke>
 <v:shadow color="#ccc [4]"/>
 <v:path insetpenok="f"/>
 <v:textbox style='mso-column-margin:0' inset="2.88pt,2.88pt,2.88pt,2.88pt"/>
</v:shape><![endif]--><![if !vml]><span style='position:absolute;z-index:1;
left:108px;top:132px;width:919px;height:9225px'>

<table cellpadding=0 cellspacing=0>
 <tr>
  <td width=919 height=9225 style='vertical-align:top'><![endif]>
  <div v:shape="_x0000_s1025" style='padding:2.88pt 2.88pt 2.88pt 2.88pt'
  class=shape>
  <p class=SPIEpapertitle><span lang=en-US style='language:en-US'>A Method for Surface Topography Measurement </span></p>
  <p class=SPIEpapertitle><span lang=en-US style='language:en-US'>using a New Focus Function </span></p>
  <p class=SPIEpapertitle><span lang=en-US style='language:en-US'>based on Dual-tree Complex Wavelet Transform</span></p>
  <p class=BodyofPaper><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=SPIEAuthorsAffils><span lang=en-US style='language:en-US'>Shimiao Li</span><span
  lang=en-US style='language:en-US'><sup>a</sup></span><span lang=en-US
  style='language:en-US'>, Tong Guo*</span><span lang=en-US style='language:
  en-US'><sup>a</sup></span><span lang=en-US style='language:en-US'> , Lin Yuan</span><span
  lang=en-US style='language:en-US'><sup>a</sup></span><span lang=en-US
  style='language:en-US'>, Jinping Chen</span><span lang=en-US
  style='language:en-US'><sup>a</sup></span></p>
  <p class=SPIEAuthorsAffils><span lang=en-US style='language:en-US'><sup>a</sup></span><span
  lang=en-US style='language:en-US'>State key laboratory of precision measurement technology and instruments, Tianjin University, Tianjin 30072,Chin</span><span
  lang=en-US style='language:en-US'>a</span></p>
  <p class=SPIEabstracttitle><span lang=en-US style='language:en-US'>Abstract&nbsp; </span></p>
  <p class=SPIEabstractbodytext><span lang=en-US style='language:en-US'>Surfac</span><span
  lang=en-US style='language:en-US'>e topography measurement is an important tool widely used in many fields to determine the characteristics and functionality of a part or material. Among existing methods for this purpose, the </span><span
  lang=en-US style='language:en-US'>f</span><span lang=en-US style='language:
  en-US'>ocus </span><span lang=en-US style='language:en-US'>v</span><span
  lang=en-US style='language:en-US'>ariation </span><span lang=en-US
  style='language:en-US'>m</span><span lang=en-US style='language:en-US'>ethod has proved high performance particularly in large slope scenarios. However, its performance depends largely on the effectiveness of </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'>. This paper presents a method for surface topography measurement using a new focus measurement function based on dual-tree complex wavelet transform. Experiments are conducted on simulated defocused images to prove its high performance in comparison with other traditional approaches. The results showed that the new algorithm has better unimodality and s</span><span
  lang=en-US style='language:en-US'>harpness. The method was also verified by measuring a MEMS micro resonator structure. </span><span
  lang=en-US style='font-style:italic;language:en-US'> </span></p>
  <p class=Keywords style='text-indent:0pt'><span lang=en-US style='font-weight:
  bold;language:en-US'>Keywords:</span><span lang=en-US style='language:en-US'> </span><span
  lang=en-US style='language:en-US'>surface topography measurement, focus variation,</span><span
  lang=en-US style='language:en-US'> focus</span><span lang=en-US
  style='language:en-US'> function, dual-tree complex wavelet transform</span></p>
  <p class=BodyofPaper><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <h1 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>INTRODUCTION </span></h1>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>F</span><span
  lang=en-US style='language:en-US'>ocus </span><span lang=en-US
  style='language:en-US'>v</span><span lang=en-US style='language:en-US'>ariation </span><span
  lang=en-US style='language:en-US'>m</span><span lang=en-US style='language:
  en-US'>ethod</span><span lang=en-US style='language:en-US'>[1][2]</span><span
  lang=en-US style='language:en-US'>, as a new optical approach for surface topography, has attracted widespread interest in fields such as ultraprecision machining, tool detection, electronic industry, material science and biomedicine[</span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>3</span><span
  lang=en-US style='language:en-US'>][</span><span lang=en-US style='language:
  en-US'><span dir=ltr></span>4</span><span lang=en-US style='language:en-US'>]. Particularly in large slope scenarios, focus variation method has proved to have higher performance. However, as focus variation method works by finding out the best focused position of each pixel, its overall performance depends largely on the effectiveness of the </span><span
  lang=en-US style='language:en-US'>focus function[5][6][7]</span><span
  lang=en-US style='language:en-US'>. </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Existing focus functions can be generally divided into </span><span
  lang=en-US style='language:en-US'>three</span><span lang=en-US
  style='language:en-US'> categories by different transform domains: functions in spatial domain, frequency domain and wavelet domain</span><span
  lang=en-US style='language:en-US'>[8][9]</span><span lang=en-US
  style='language:en-US'>. Commonly used functions in spatial domains mainly involve Gray Level Variance (GLV) proposed by Krotkov in 1988, Tenengrad Method (TEN)</span><span
  lang=en-US style='language:en-US'>[10]</span><span lang=en-US
  style='language:en-US'> and Sum Modified Laplacian (SML) proposed by Nakagava in 1994.</span><span
  lang=en-US style='language:en-US'> Algorithms based on frequency domain and wavelet domain takes many forms. They majority of them rely on measurements of high-frequency components after transform. </span><span
  lang=en-US style='language:en-US'>Existing wavelet</span><span lang=en-US
  style='language:en-US'>-based</span><span lang=en-US style='language:en-US'> functions are mainly based on traditional wavelet transform, which becomes popular in recent studies due to its benefits in providing both positional information and frequency information</span><span
  lang=en-US style='language:en-US'>[11]</span><span lang=en-US
  style='language:en-US'>. However, the existing algorithms are not optimal in extracting high-frequency details due to its limited direction selectivity.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>This paper presents an alternative focus function</span><span
  lang=en-US style='language:en-US'> </span><span lang=en-US style='language:
  en-US'>based on</span><span lang=en-US style='language:en-US'> dual-tree complex wavelet transform</span><span
  lang=en-US style='language:en-US'> (DCDWT)</span><span lang=en-US
  style='language:en-US'>. </span><span lang=en-US style='language:en-US'>Theoretically, DTCWT enables an observation of variation from 6 distinct directions and a resulting better extraction of detail information than traditional algorithms do[12][13]. Thus the newly proposed function takes advantage of the superior </span><span
  lang=en-US style='language:en-US'>direction selectivity</span><span
  lang=en-US style='language:en-US'> to better evaluate the focusing degree of images</span><span
  lang=en-US style='language:en-US'>. </span><span lang=en-US style='language:
  en-US'>Also, the proposed function used </span><span lang=en-US
  style='language:en-US'>in surface topography measurement is </span><span
  lang=en-US style='language:en-US'>a new</span><span lang=en-US
  style='language:en-US'> </span><span lang=en-US style='language:en-US'>application of DTCWT</span><span
  lang=en-US style='language:en-US'>.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The rest of the paper is organized as follows. In Section 2, the traditional methods are reviewed and the newly proposed </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'> is introduced. In Section 3, experiments are conducted using image defocused simulation to prove the higher performance of the newly proposed focus measurement function. In Section</span><span
  lang=en-US style='language:en-US'> 4, the method is applied in measuring a MEMS micro resonator structure. Finally, some conclusions are made in Section 5.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <h1 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>Principle of measurement</span></h1>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Focus </span><span
  lang=en-US style='language:en-US'>v</span><span lang=en-US style='language:
  en-US'>ariation method is based on a combination of vertical scanning and </span><span
  lang=en-US style='language:en-US'>an </span><span lang=en-US
  style='language:en-US'>optical system with a small depth of field. </span><span
  lang=en-US style='language:en-US'>The principle of measurement</span><span
  lang=en-US style='language:en-US'> depends largely on the model of focused and defocused imaging. </span><span
  lang=en-US style='language:en-US'>As is illustrated in Fig. 1, when</span><span
  lang=en-US style='language:en-US'> the objective lens scans vertically with a certain step distance</span><!--[if gte vml 1]><v:shapetype
   id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
   path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
   <v:stroke joinstyle="miter"/>
   <v:formulas>
    <v:f eqn="if lineDrawn pixelLineWidth 0"/>
    <v:f eqn="sum @0 1 0"/>
    <v:f eqn="sum 0 0 @1"/>
    <v:f eqn="prod @2 1 2"/>
    <v:f eqn="prod @3 21600 pixelWidth"/>
    <v:f eqn="prod @3 21600 pixelHeight"/>
    <v:f eqn="sum @0 0 1"/>
    <v:f eqn="prod @6 1 2"/>
    <v:f eqn="prod @7 21600 pixelWidth"/>
    <v:f eqn="sum @8 21600 0"/>
    <v:f eqn="prod @7 21600 pixelHeight"/>
    <v:f eqn="sum @10 21600 0"/>
   </v:formulas>
   <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
   <o:lock v:ext="edit" aspectratio="t"/>
  </v:shapetype><v:shape id="对象_x0020_6" o:spid="_x0000_s1027" type="#_x0000_t75"
   style='width:5.57053mm;height:12.95pt;mso-wrap-distance-left:2.88pt;
   mso-wrap-distance-top:2.88pt;mso-wrap-distance-right:2.88pt;
   mso-wrap-distance-bottom:2.88pt;mso-position-horizontal:absolute;
   mso-position-horizontal-relative:page;mso-position-vertical-relative:page'
   fillcolor="white [7]" strokecolor="black [0]" o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image295.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=31
  height=26 src="paper2.files/image2951.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_6"
    DrawAspect="Content" ObjectID="0">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>and takes a picture at every step, the system acquires a sequence of images. Points on the sample surface are scanned</span><span
  lang=en-US style='language:en-US'> and imaged on CCD.</span><span lang=en-US
  style='language:en-US'> </span><span lang=en-US style='language:en-US'>E</span><span
  lang=en-US style='language:en-US'>ach of them goes through a process of being defocused, focused and again defocused. For each pixel </span><span
  lang=en-US style='language:en-US'>on</span><span lang=en-US style='language:
  en-US'> the same location of the sequence image, </span><span lang=en-US
  style='language:en-US'>effective </span><span lang=en-US style='language:
  en-US'>focus measurement is implemented </span><span lang=en-US
  style='language:en-US'>on its neighborhood </span><span lang=en-US
  style='language:en-US'>to </span><span lang=en-US style='language:en-US'>precisely evaluate its degree of focus. By comparing the values from different images, we can obtain the serial number of the best focused image of the measured pixel and roughly estimate</span><span
  lang=en-US style='language:en-US'> the depth of</span><span lang=en-US
  style='language:en-US'> the corresponding point on sample surface. Further, one can also adopt interpolation to get depth map with higher accuracy.</span></p>
  <p class=SPIEfigure style='page-break-after:avoid'><!--[if gte vml 1]><v:shape
   id="图片_x0020_57" o:spid="_x0000_s1028" type="#_x0000_t75" style='width:64.07942mm;
   height:184.68pt;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image297.png" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=363
  height=369 src="paper2.files/image2971.gif"><![endif]></p>
  <p class=SPIEfigurecaption style='margin-left:18.0pt'><span lang=en-US
  style='language:en-US'>Figure </span><span dir=ltr></span>1. (1)<span
  lang=en-US style='language:en-US'>CCD (2)lens (3)light splitter (4)light source (5) sample (6)motor (7)ring illuminator (optional) (8)sequence image (9)ray of light</span></p>
  <p class=SPIEfigureright style='page-break-after:avoid;text-align:justify;
  text-justify:inter-ideograph;text-align:justify;text-justify:inter-ideograph'><span
  lang=en-US style='language:en-US'>&nbsp;</span></p>
  <h1 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>Focus Measurement function</span></h1>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The essential step of </span><span
  lang=en-US style='language:en-US'>f</span><span lang=en-US style='language:
  en-US'>ocus </span><span lang=en-US style='language:en-US'>v</span><span
  lang=en-US style='language:en-US'>ariation </span><span lang=en-US
  style='language:en-US'>m</span><span lang=en-US style='language:en-US'>ethod is to find out the </span><span
  lang=en-US style='language:en-US'>best focused position of from the image sequence.</span><span
  lang=en-US style='language:en-US'> To serve this purpose, an effective </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'> is needed to accurately evaluate the focusing or defocusing level of every pixel.</span></p>
  <h2 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>Traditional algorithms </span></h2>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Commonly used traditional functions involve GLV, TEN, SML and DWT-based functions. </span><span
  lang=en-US style='language:en-US'>In terms of</span><span lang=en-US
  style='language:en-US'> DWT-based functions, </span><span lang=en-US
  style='language:en-US'>we discuss the use of </span><span lang=en-US
  style='language:en-US'>one-layer orthogonal wavelet decomposition since only a small neighborhood is selected when evaluating each pixel. After the transform, we can obtain one low-frequency sub-band LL, and 3 high-frequency ones HL, LH, HH which present detail information in the horizontal, vertical and diagonal direction, respectively.&nbsp; </span></p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'>
  <table style='display:inline' cellpadding=0 cellspacing=0 width=114
   height=98 border=0 dir=ltr style='width:85.6pt;height:73.55pt;border-collapse:
   collapse'>
   <tr>
    <td width=53 height=48 style='width:40.1pt;height:35.95pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>LL1</span></p>
    </td>
    <td width=61 height=48 style='width:45.5pt;height:35.95pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>HL1</span></p>
    </td>
   </tr>
   <tr>
    <td width=53 height=50 style='width:40.1pt;height:37.6pt;padding-left:2.88pt;
    padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>LH1</span></p>
    </td>
    <td width=61 height=50 style='width:45.5pt;height:37.6pt;padding-left:2.88pt;
    padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>HH1</span></p>
    </td>
   </tr>
  </table>
  </p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'><span lang=en-US style='language:en-US'>Figure </span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>2</span><span
  lang=en-US style='language:en-US'>.The block diagram of one-layer DWT</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Functions can be constructed by measuring and analyzing the high-frequency components. </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>One way is to summarize the absolute values of the high-frequency components:</span><span
  lang=en-US style='language:en-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
  <p class=SPIEbodytext style='text-indent:160.0pt'><!--[if gte vml 1]><v:shape
   id="对象_x0020_12" o:spid="_x0000_s1030" type="#_x0000_t75" style='width:203.82pt;
   height:7.35486mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image301.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=407
  height=41 src="paper2.files/image3011.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_12"
    DrawAspect="Content" ObjectID="1">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (1)</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Also it is popular to measure the high-frequency energy in the neighborhood:</span></p>
  <p class=SPIEbodytext style='text-indent:150.0pt'><!--[if gte vml 1]><v:shape
   id="对象_x0020_13" o:spid="_x0000_s1031" type="#_x0000_t75" style='width:78.25156mm;
   height:8.58625mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image303.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=443
  height=48 src="paper2.files/image3031.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_13"
    DrawAspect="Content" ObjectID="2">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (2)</span></p>
  <h2 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>Proposed DTCWT-based function </span></h2>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Although the traditional wavelet transform can extract information at particular scales and directions, it still lacks directionality. DWT-based algorithms can only detect features in </span><span
  lang=en-US style='language:en-US'>three</span><span lang=en-US
  style='language:en-US'> limited directions, in which case it fails to distill information in some ridges and edges. These factors will limit the effectiveness of the </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'>. </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>One solution is to use the dual-tree complex wavelet transfo</span><span
  lang=en-US style='language:en-US'>rm proposed by Nick G.Kingsbury in 2005. In this paper, </span><span
  lang=en-US style='language:en-US'>we implement a one-layer </span><span
  lang=en-US style='language:en-US'>DTCWT</span><span lang=en-US
  style='language:en-US'>, as Fig. 3 shows,</span><span lang=en-US
  style='language:en-US'> </span><span lang=en-US style='language:en-US'>which </span><span
  lang=en-US style='language:en-US'>can be describe</span><span lang=en-US
  style='language:en-US'>d</span><span lang=en-US style='language:en-US'> as two parallel transform: one results in the real part and the other results in the image part. Each transform </span><span
  lang=en-US style='language:en-US'>also </span><span lang=en-US
  style='language:en-US'>contains a parallel 2D-DWT.</span></p>
  <p class=SPIEfigure style='page-break-after:avoid'><!--[if gte vml 1]><v:shape
   id="图片_x0020_64" o:spid="_x0000_s1032" type="#_x0000_t75" style='width:119.3087mm;
   height:85.99717mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image305.png" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=676
  height=487 src="paper2.files/image3051.gif"><![endif]></p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'><span lang=en-US style='language:en-US'>Figure </span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>3</span><span
  lang=en-US style='language:en-US'>. </span><span lang=en-US style='language:
  en-US'>T</span><span lang=en-US style='language:en-US'>he realization of one-layer DTCWT</span><span
  lang=en-US style='language:en-US'> in the proposed focus function</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The final DTCWT coefficients are</span><span
  lang=en-US style='language:en-US'> obtained by </span><span lang=en-US
  style='language:en-US'>sum</span><span lang=en-US style='language:en-US'>ming up</span><span
  lang=en-US style='language:en-US'> the corresponding real and image part.</span></p>
  <p class=SPIEbodytext style='text-indent:160.0pt'><!--[if gte vml 1]><v:shape
   id="对象_x0020_16" o:spid="_x0000_s1033" type="#_x0000_t75" style='width:138.6pt;
   height:16.95pt;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image306.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=277
  height=34 src="paper2.files/image3061.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_16"
    DrawAspect="Content" ObjectID="3">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (3)</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>After a one-layer DTCWT, information can be distinguished in </span><span
  lang=en-US style='language:en-US'>four</span><span lang=en-US
  style='language:en-US'> distinct directions involving the horizontal, vertical, 45°and-45°direction. The newly proposed </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'> is obtained by squaring the sum of the absolute value of coefficients in </span><span
  lang=en-US style='language:en-US'>four</span><span lang=en-US
  style='language:en-US'> directions.</span></p>
  <p class=SPIEbodytext style='text-indent:100.0pt'><!--[if gte vml 1]><v:shape
   id="对象_x0020_17" o:spid="_x0000_s1034" type="#_x0000_t75" style='width:92.83928mm;
   height:6.77561mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image308.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=526
  height=38 src="paper2.files/image3081.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_17"
    DrawAspect="Content" ObjectID="4">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (4)</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Where in our function,</span></p>
  <p class=SPIEbodytext style='text-align:center;text-align:center'><!--[if gte vml 1]><v:shape
   id="对象_x0020_18" o:spid="_x0000_s1035" type="#_x0000_t75" style='width:97.59383mm;
   height:12.5137mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image310.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=553
  height=71 src="paper2.files/image3101.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_18"
    DrawAspect="Content" ObjectID="5">
   </o:OLEObject>
  </xml><![endif]--></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>According to our analysis and experiments, the proposed square form (the square of the sum of components) is better than other possible forms like the energy form (the sum of the square of components), cubic form and others, considering </span><span
  lang=en-US style='language:en-US'>a trade-off between sharpness of the function and its computational complexity</span><span
  lang=en-US style='language:en-US'>.</span></p>
  <p class=StyleSPIEfigurecaption style='margin-right:35.2999pt;text-indent:
  0pt'><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <h1 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>Experiment to compare performances of functions</span></h1>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The experimental verification of the </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'> requires a sequence of images with different degree of focus. However, noise and unknown disturbance always exist </span><span
  lang=en-US style='language:en-US'>in reality </span><span lang=en-US
  style='language:en-US'>and can affect the evaluation. To get accurate assessment, one can use computer modelling to simulate defocused images.&nbsp; </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>According to geometrical optics, when the object lies at a distance</span><!--[if gte vml 1]><v:shape
   id="对象_x0020_19" o:spid="_x0000_s1036" type="#_x0000_t75" style='width:7.93431mm;
   height:12.95pt;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image312.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=45
  height=26 src="paper2.files/image3121.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_19"
    DrawAspect="Content" ObjectID="6">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>from the best focused position, the acquired image is blurred and an object point results in a circle of confusion, as is illustrated in Fig.4. </span></p>
  <p class=SPIEfigure style='page-break-after:avoid'><!--[if gte vml 1]><v:shape
   id="图片_x0020_63" o:spid="_x0000_s1037" type="#_x0000_t75" style='width:80.69544mm;
   height:50.70261mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image314.png" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=457
  height=287 src="paper2.files/image3141.gif"><![endif]></p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'><span lang=en-US style='language:en-US'>Figure </span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>4</span><span
  lang=en-US style='language:en-US'>. The mathematical model of image defocus in Focus Variation</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The defocusing degradation of image can be explained by a disc blur model:</span></p>
  <p class=SPIEbodytext style='text-indent:180.0pt'><!--[if gte vml 1]><v:shape
   id="对象_x0020_23" o:spid="_x0000_s1038" type="#_x0000_t75" style='width:123pt;
   height:14.30178mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image315.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=246
  height=81 src="paper2.files/image3151.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_23"
    DrawAspect="Content" ObjectID="7">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (5)&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Here in this experiment, 15 images were simulated by setting f=4.5mm, D=6.5mm, u0=4.8mm, N=-7~+7</span><span
  lang=en-US style='language:en-US'>,</span><span lang=zh-CN style='font-family:
  宋体;language:zh-CN'>△</span><span lang=en-US style='language:en-US'>d=500nm</span><span
  lang=en-US style='language:en-US'>. The performance of </span><span
  lang=en-US style='language:en-US'>focus function</span><span lang=en-US
  style='language:en-US'>s are as follows.</span></p>
  <p class=SPIEfigure style='page-break-after:avoid'><!--[if gte vml 1]><v:shape
   id="图片_x0020_14" o:spid="_x0000_s1039" type="#_x0000_t75" style='width:458.4pt;
   height:139.16pt;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image317.png" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=917
  height=278 src="paper2.files/image3171.gif"><![endif]></p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'><span lang=en-US style='language:en-US'>Figure </span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>5</span><span
  lang=en-US style='language:en-US'>. Performances of different functions</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>We compared the GLV, TEN, SML, two DWT-based functions (3)(4) and the proposed (5). Obviously, in Fig.5, the new function is usable and shows the best result with good unimodality and better sharpness than other algorithms.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <h1 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>Experiment on MEMS micro resonator structure</span></h1>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>We have built an optical system for focus variation measurement in our laboratory. The configuration of the system is shown in Table 1.</span></p>
  <p class=SPIEfigurecaption style='text-align:center;text-align:center'><span
  lang=en-US style='language:en-US'>Table </span><span lang=en-US
  style='language:en-US'><span dir=ltr></span>1</span><span lang=en-US
  style='language:en-US'>.&nbsp; Configuration of the focus variation system we built.</span></p>
  <p class=SPIEbodytext>
  <table style='display:inline' cellpadding=0 cellspacing=0 width=372
   height=113 border=0 dir=ltr style='width:279.0pt;height:84.4257pt;
   border-collapse:collapse'>
   <tr>
    <td width=156 height=25 valign=Top style='width:117.0pt;height:19.1588pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:11.0pt;font-weight:bold;language:en-US'>Section</span></p>
    </td>
    <td width=216 height=25 valign=Top style='width:162.0pt;height:19.1588pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:11.0pt;font-weight:bold;language:en-US'>Product Model</span></p>
    </td>
   </tr>
   <tr>
    <td width=156 height=39 valign=Top style='width:117.0pt;height:29.2579pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Light source</span></p>
    </td>
    <td width=216 height=39 valign=Top style='width:162.0pt;height:29.2579pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=MsoNormal><span lang=en-US style='font-size:10.0pt;language:en-US'>CCS HL V2-3M-RGB-3W</span></p>
    <p class=SPIEbodytext><span lang=en-US style='language:en-US'>CCS PJ-15-5-3CA (light controller)</span></p>
    </td>
   </tr>
   <tr>
    <td width=156 height=24 valign=Top style='width:117.0pt;height:18.0pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Microscope</span></p>
    </td>
    <td width=216 height=24 valign=Top style='width:162.0pt;height:18.0pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Nikon CM-70L</span></p>
    </td>
   </tr>
   <tr>
    <td width=156 height=24 valign=Top style='width:117.0pt;height:18.0088pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext><span lang=en-US style='language:en-US'>CCD</span></p>
    </td>
    <td width=216 height=24 valign=Top style='width:162.0pt;height:18.0088pt;
    padding-left:2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:
    2.88pt;border:solid black .5pt'>
    <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Basler A 102K</span></p>
    </td>
   </tr>
  </table>
  </p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>In this section, the proposed method is verified </span><span
  lang=en-US style='language:en-US'>on our system </span><span lang=en-US
  style='language:en-US'>by measuring a</span><span lang=en-US
  style='language:en-US'> </span><span lang=en-US style='language:en-US'>MEMS micro resonator structure</span><span
  lang=en-US style='language:en-US'>. </span><span lang=en-US style='language:
  en-US'>The main proce</span><span lang=en-US style='language:en-US'>dures </span><span
  lang=en-US style='language:en-US'>are illustrated in Fig.6.</span></p>
  <p class=SPIEfigure style='page-break-after:avoid'><!--[if gte vml 1]><v:shape
   id="图片_x0020_13" o:spid="_x0000_s1041" type="#_x0000_t75" style='width:54.23058mm;
   height:80.50811mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image321.png" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=307
  height=456 src="paper2.files/image3211.jpg"><![endif]></p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'><span lang=en-US style='language:en-US'>Figure </span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>6</span><span
  lang=en-US style='language:en-US'>. Main </span><span lang=en-US
  style='language:en-US'>image-processing </span><span lang=en-US
  style='language:en-US'>procedures</span><span lang=en-US style='language:
  en-US'> of focus variation method for surface measurement</span><span
  lang=en-US style='language:en-US'>.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>In our experiment, </span><span
  lang=en-US style='language:en-US'>twenty-five</span><span lang=en-US
  style='language:en-US'> images were acquired by setting</span><!--[if gte vml 1]><v:shape
   id="对象_x0020_29" o:spid="_x0000_s1042" type="#_x0000_t75" style='width:16.36781mm;
   height:3.79181mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image322.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=93
  height=21 src="paper2.files/image3221.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_29"
    DrawAspect="Content" ObjectID="8">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>. </span><span
  lang=en-US style='language:en-US'>As the first step of image processing, Gaussian filter was used to remove noise and reserve detail. The focus-measurement procedure was then implemented by setting window size</span><!--[if gte vml 1]><v:shape
   id="对象_x0020_30" o:spid="_x0000_s1043" type="#_x0000_t75" style='width:20.95pt;
   height:4.17353mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image324.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=42
  height=23 src="paper2.files/image3241.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_30"
    DrawAspect="Content" ObjectID="9">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>and using the filter group</span><!--[if gte vml 1]><v:shape
   id="对象_x0020_31" o:spid="_x0000_s1044" type="#_x0000_t75" style='width:14.30178mm;
   height:5.16853mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image326.wmz" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=81
  height=29 src="paper2.files/image3261.gif"><![endif]><!--[if gte mso 9]><xml>
   <o:OLEObject Type="Embed" ProgID="Equation.3" ShapeID="对象_x0020_31"
    DrawAspect="Content" ObjectID="10">
   </o:OLEObject>
  </xml><![endif]--><span lang=en-US style='language:en-US'>for DTCWT</span><span
  lang=en-US style='language:en-US'>. Next, Gaussian interpolation was adopted for higher resolution and precision.</span><span
  lang=en-US style='language:en-US'> </span><span lang=en-US style='language:
  en-US'>To reduce computational complexity, interpolation was implemented only on the three consecutive points centered by the maximum point of the focus-measurement curve. In the next step, we adopted a final check procedure based on Smallest Univalue Segment Assimilating Nucleus (SUSAN) operator to remove outlier</span><span
  lang=en-US style='color:black;language:en-US'>s</span><span lang=en-US
  style='language:en-US'>. Finally, </span><span lang=en-US style='language:
  en-US'>th</span><span lang=en-US style='language:en-US'>e step height on the sample was measured.</span><span
  lang=en-US style='language:en-US'> </span><span lang=en-US style='language:
  en-US'>The Results of the experiment are shown in Fig.</span><span
  lang=en-US style='language:en-US'> 7:</span></p>
  <p class=SPIEfigure style='page-break-after:avoid'><!--[if gte vml 1]><v:shape
   id="图片_x0020_20" o:spid="_x0000_s1045" type="#_x0000_t75" style='width:429.1pt;
   height:62.82672mm;mso-wrap-distance-left:2.88pt;mso-wrap-distance-top:2.88pt;
   mso-wrap-distance-right:2.88pt;mso-wrap-distance-bottom:2.88pt;
   mso-position-horizontal:absolute;mso-position-horizontal-relative:page;
   mso-position-vertical-relative:page' fillcolor="white [7]" strokecolor="black [0]"
   o:cliptowrap="t">
   <v:fill color2="white [7]" o:detectmouseclick="t"/>
   <v:stroke color2="white [7]">
    <o:left v:ext="view" color="black [0]" color2="white [7]"/>
    <o:top v:ext="view" color="black [0]" color2="white [7]"/>
    <o:right v:ext="view" color="black [0]" color2="white [7]"/>
    <o:bottom v:ext="view" color="black [0]" color2="white [7]"/>
    <o:column v:ext="view" color="black [0]" color2="white [7]"/>
   </v:stroke>
   <v:imagedata src="paper2.files/image328.png" o:title=""/>
   <v:shadow color="#ccc [4]"/>
   <v:path insetpenok="f"/>
   <o:lock v:ext="edit" ungrouping="t" grouping="t"/>
  </v:shape><![endif]--><![if !word & !ppt & !excel & !vml]><img width=858
  height=356 src="paper2.files/image3281.gif"><![endif]></p>
  <p class=SPIEfigurecaption style='margin-left:18.0pt'><span lang=en-US
  style='language:en-US'>(a) F</span><span lang=en-US style='language:en-US'>inal depth map </span><span
  lang=en-US style='language:en-US'>(b)F</span><span lang=en-US
  style='language:en-US'>inal sectional view&nbsp; </span><span lang=en-US
  style='language:en-US'>(c) F</span><span lang=en-US style='language:en-US'>ocus-measurement curve of pixel (20,20)</span><span
  lang=en-US style='language:en-US'>&nbsp; (d) </span><span lang=en-US
  style='language:en-US'>Sectional view before interpolation&nbsp; </span><span
  lang=en-US style='language:en-US'>(e) </span><span lang=en-US
  style='language:en-US'>Sectional view after interpolation&nbsp; </span><span
  lang=en-US style='language:en-US'>(f) </span><span lang=en-US
  style='language:en-US'>Depth map before the final check&nbsp; </span><span
  lang=en-US style='language:en-US'>(g) </span><span lang=en-US
  style='language:en-US'>Depth map after the final check</span><span
  lang=en-US style='font-size:8.0pt;language:en-US'> </span></p>
  <p class=SPIEfigurecaption style='text-align:center;margin-left:18.0pt;
  text-align:center'><span lang=en-US style='language:en-US'>Figure</span><span
  lang=en-US style='language:en-US'> 7</span><span lang=en-US style='language:
  en-US'>.</span><span lang=en-US style='language:en-US'> Results of experiment on MEMS structure.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The measuring results of the step height were shown in Table 2.</span></p>
  <p class=SPIEfigurecaption style='text-align:center;text-align:center'><span
  lang=en-US style='language:en-US'>Table </span><span lang=en-US
  style='language:en-US'><span dir=ltr></span>2</span><span lang=en-US
  style='language:en-US'>.&nbsp; Height of the step on the sample(</span><span
  lang=el style='font-family:"Times New Roman";language:el'>μ</span><span
  lang=en-US style='language:en-US'>m).</span></p>
  <p class=SPIEbodytext>
  <table style='display:inline' cellpadding=0 cellspacing=0 width=495
   height=199 border=0 dir=ltr style='width:371.6pt;height:149.6pt;border-collapse:
   collapse'>
   <tr>
    <td width=209 height=26 style='width:156.85pt;height:19.75pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:11.0pt;font-weight:bold;language:en-US'>Number of measurement</span></p>
    </td>
    <td width=286 height=26 style='width:214.75pt;height:19.75pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:11.0pt;font-weight:bold;language:en-US'>Height(</span><span
    lang=el style='font-size:11.0pt;font-family:"Times New Roman";font-weight:
    bold;language:el'>μ</span><span lang=en-US style='font-size:11.0pt;
    font-weight:bold;language:en-US'>m)</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=25 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>1</span></p>
    </td>
    <td width=286 height=25 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>3.8948</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=25 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>2</span></p>
    </td>
    <td width=286 height=25 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>3.9127</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=24 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>3</span></p>
    </td>
    <td width=286 height=24 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>3.9197</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=25 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>4</span></p>
    </td>
    <td width=286 height=25 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>3.9051</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=25 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>5</span></p>
    </td>
    <td width=286 height=25 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>3.8750</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=25 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>Average height</span></p>
    </td>
    <td width=286 height=25 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>3.9015</span></p>
    </td>
   </tr>
   <tr>
    <td width=209 height=24 style='width:156.85pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=SPIEbodytext style='text-align:center;text-align:center'><span
    lang=en-US style='language:en-US'>Standard deviation</span></p>
    </td>
    <td width=286 height=24 style='width:214.75pt;height:18.55pt;padding-left:
    2.88pt;padding-right:2.88pt;padding-top:2.88pt;padding-bottom:2.88pt;
    border:solid black .5pt'>
    <p class=MsoNormal style='text-align:center;text-align:center'><span
    lang=en-US style='font-size:10.0pt;language:en-US'>0.0175</span></p>
    </td>
   </tr>
  </table>
  </p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>For reference, the sample was also tested by a Sensofar 3D optical profilometer which gave the average height 3.9086μm and standard deviation 0.0011μm.</span><span
  lang=en-US style='language:en-US'> </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Therefore, the </span><span
  lang=en-US style='language:en-US'>surface topography reconstruction result in Fig. 7 and depth measurement results in Table 2 </span><span
  lang=en-US style='language:en-US'>show that the proposed method has good performance in restoring surface topography and </span><span
  lang=en-US style='language:en-US'>good accuracy for surface measurement</span><span
  lang=en-US style='language:en-US'>.</span></p>
  <p class=MsoNormal><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <h1 style='page-break-after:avoid'><span lang=en-US style='language:en-US'>conclusion</span></h1>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>Our results provide evidence for the effectiveness of the new DTCWT-based function as well as the whole image-processing method. The result in Fig.</span><span
  lang=en-US style='language:en-US'><span dir=ltr></span>5</span><span
  lang=en-US style='language:en-US'> suggests that the new function is usable and shows </span><span
  lang=en-US style='language:en-US'>better</span><span lang=en-US
  style='language:en-US'> result with a very narrow peak which indicates better sharpness</span><span
  lang=en-US style='language:en-US'> than traditional ones</span><span
  lang=en-US style='language:en-US'>. Meanwhile, </span><span lang=en-US
  style='language:en-US'>experiment on MEMS</span><span lang=en-US
  style='language:en-US'> show</span><span lang=en-US style='language:en-US'>s</span><span
  lang=en-US style='language:en-US'> </span><span lang=en-US style='language:
  en-US'>that the image-processing procedures provide </span><span lang=en-US
  style='language:en-US'>good accuracy in restoring </span><span lang=en-US
  style='language:en-US'>and measuring </span><span lang=en-US
  style='language:en-US'>surface topography.</span><span lang=en-US
  style='language:en-US'> </span><span lang=en-US style='language:en-US'> </span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>T</span><span
  lang=en-US style='language:en-US'>he proposed function shows obvious improvement than traditional algorithms in focus measurement. We have implemented the fun</span><span
  lang=en-US style='language:en-US'>ctions in the focus-variation measuring system in our laboratory and in the process of applying it to large-sample measurement using image stitching.</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=MsoNormal style='text-align:center;line-height:150%;text-align:center'><span
  lang=en-US style='font-size:11.0pt;line-height:150%;font-weight:bold;
  language:en-US'>ACKNOWLEDGMENTS</span></p>
  <p class=SPIEbodytext><span lang=en-US style='language:en-US'>The authors gratefully acknowledge the support of The National Key Research and Development Program of China (Grant No. 2017YFF0105905) and the 111 Project fund (Grant No. B07014). </span></p>
  <p class=SPIEreferences style='page-break-after:avoid'><span lang=en-US
  style='language:en-US'>References</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=en-US style='language:en-US'>Saxton W O. What is the focus variation method? Is it new? Is it direct?[J]. Ultramicroscopy, 1994, 55(2):171-181.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=en-US style='language:en-US'>Helmli F. Focus Variation Instruments[M]// Optical Measurement of Surface Topography. Springer Berlin Heidelberg, 2011:131-166.</span><span
  lang=en-US style='language:en-US'>&nbsp;</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Peng, Fangyu, Wu, et al. </span><span lang=de
  style='language:de'>Modeling and controlling of surface micro-topography feature in;micro-ball-end milling[J]. International Journal of Advanced Manufacturing Technology, 2013, 67(9-12):2657-2670.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Abdullah A B, Sapuan S M, Samad Z. Profile Measurement Based on Focus Variation Method for Geometrical Defect Evaluation: A Case Study of Cold Forged Propeller Blade[J]. Advances in Mechanical Engineering, 2014, 6(1):874691-874691.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Mahmood M T, Majid A, Choi T S. Optimal depth estimation by combining focus measures using genetic programming[J]. Information Sciences, 2011, 181(7):1249-1263.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Kurban R, Aslantas V. A Comparison of Different Focus Measures For Use In Fusion Of Multi-Focus Noisy Images[C]// International Conference on Information Technology. 2009</span><span
  lang=en-US style='language:en-US'>.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Groen F C, Young I T, Ligthart G. A comparison of different focus functions for use in autofocus algorithms.[J]. Cytometry, 2010, 6(2):81-91.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Huang W, Jing Z. Evaluation of focus measures in multi-focus image fusion[J]. Pattern Recognition Letters, 2007, 28(4):493-500.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Huang W, Jing Z. Evaluation of focus measures in multi-focus image fusion[J]. Pattern Recognition Letters, 2007, 28(4):493-500.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Choudhury A, Medioni G. Hierarchy of nonlocal means for preferred automatic sharpness enhancement and tone mapping[J]. Journal of the Optical Society of America A Optics Image Science &amp; Vision, 2013, 30(3):353-66.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Kautsky J, Flusser J, Zitová B, et al. </span><span
  lang=de style='language:de'>A new wavelet-based measure of image focus[J]. Pattern Recognition Letters, 2002, 23(14):1785-1794.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Selesnick I W, Baraniuk R G, Kingsbury N C. The dual-tree complex wavelet transform[J]. IEEE Signal Processing Magazine, 2005, 22(6):123-151.</span></p>
  <p class=SPIEreferencelisting style='margin-left:36.0pt;text-indent:-18.0pt'><span
  lang=de style='language:de'>Kingsbury N. The Dual-Tree Complex Wavelet Transform: A New Technique For Shift Invariance And Directional Filters[J]. Image Processing, 1998:319--322.</span></p>
  <p class=MsoNormal><span lang=en-US style='language:en-US'>&nbsp;</span></p>
  </div>
  <![if !vml]></td>
 </tr>
</table>

</span><![endif]>
</div>

</body>

</html>
